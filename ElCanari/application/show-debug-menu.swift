//----------------------------------------------------------------------------------------------------------------------
//  THIS FILE IS GENERATED BY EASY BINDINGS, DO NOT MODIFY IT
//  Created by Pierre Molinaro on 14/06/2021.
//----------------------------------------------------------------------------------------------------------------------

import Cocoa

//----------------------------------------------------------------------------------------------------------------------
//   Public function
//----------------------------------------------------------------------------------------------------------------------

func instanciateDebugMenuVisibilityObjectOnDidFinishLaunchingNotification () {
  gDebugMenuVisibility = DebugMenuVisibility ()
}

//----------------------------------------------------------------------------------------------------------------------
//   Private entities
//----------------------------------------------------------------------------------------------------------------------

fileprivate var gDebugMenuVisibility : DebugMenuVisibility? = nil

//----------------------------------------------------------------------------------------------------------------------

fileprivate final class DebugMenuVisibility : BaseObject {

  //····················································································································
  //  Property
  //····················································································································

  private var mDebugMenuItem = NSMenuItem (title: "Debug", action: nil, keyEquivalent: "")
  private var mShowMenuController : EBReadOnlyPropertyController? = nil

  //····················································································································
  //  Init
  //····················································································································

  override init () {
    super.init ()
    let menu = NSMenu (title: "Debug")
    self.mDebugMenuItem.submenu = menu
    self.mShowMenuController = EBReadOnlyPropertyController (
      observedObjects: [preferences_showDebugMenu_property],
      callBack: { self.updateDebugMenuVisibility () }
    )
    appendAllocationDebugMenuItems (menu)
    appendShowTransientEventLogWindowMenuItem (menu)
    appendShowExploreDocumentWindowMenuItem (menu)
    appendShowDocumentFileOperationDurationWindowMenuItem (menu)
    appendDebugAutoLayoutMenuItem (menu)
  }

  //····················································································································

  func updateDebugMenuVisibility () {
    if let mainMenu = NSApp.mainMenu {
      if preferences_showDebugMenu_property.propval {
        mainMenu.addItem (mDebugMenuItem)
      }else if mainMenu.index (of: mDebugMenuItem) >= 0 {
        mainMenu.removeItem (mDebugMenuItem)
      }
    }
  }

  //····················································································································

}

//----------------------------------------------------------------------------------------------------------------------
