//--- START OF USER ZONE 1


//--- END OF USER ZONE 1
//——————————————————————————————————————————————————————————————————————————————————————————————————
//  THIS FILE IS REGENERATED BY EASY BINDINGS, ONLY MODIFY IT WITHIN USER ZONES
//——————————————————————————————————————————————————————————————————————————————————————————————————

import AppKit

//——————————————————————————————————————————————————————————————————————————————————————————————————

extension AutoLayoutProjectDocument {
  @objc func deleteSheetAction (_ inSender : NSObject?) {
//--- START OF USER ZONE 2
      if self.rootObject.mSheets.count > 1,
         let selectedSheet = self.rootObject.mSelectedSheet,
         let idx = self.rootObject.mSheets.firstIndex (of: selectedSheet) {
      //--- Remove all objects
         for point in selectedSheet.mPoints.values {
           point.mSheet = nil
           point.mSymbol = nil
           point.mSymbolPinName = ""
         }
         for object in selectedSheet.mObjects.values {
           object.operationBeforeRemoving ()
           object.mSheet = nil
         }
      //---
        self.rootObject.mSheets.remove (at: idx)
        let newSelectedSheetIndex = min (idx, self.rootObject.mSheets.count - 1)
        self.rootObject.mSelectedSheet = self.rootObject.mSheets [newSelectedSheetIndex]
      }
//--- END OF USER ZONE 2
  }
}

//——————————————————————————————————————————————————————————————————————————————————————————————————
